<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta charset="UTF-8">
    <title>Login Page</title>
    <style>
        body {
            background-image: url("https://images.pexels.com/photos/2008145/pexels-photo-2008145.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1");
            background-size: cover;
            background-position: center;
        }

        .divider:after,
        .divider:before {
            content: "";
            flex: 1;
            height: 1px;
            background: #eee;
        }

        .h-custom {
            height: 100vh;
        }

    </style>
</head>

<body>
<section class="vh-100">
    <div class="container-fluid h-custom">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-md-9 col-lg-6 col-xl-5">

            </div>
            <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
                <form id="loginForm" th:action="@{/api/v1/auth/authenticate}" method="POST" onsubmit="return validateForm()" >
            <!--    <form id="loginForm" th:action="@{/process-login}" method="POST" onsubmit="return validateForm()" enctype="application/json"> -->

                    <div th:if="${param.error}">
                        <div class="alert alert-danger col-xs-offset-1 col-xs-10">
                            Invalid username and password.
                        </div>
                    </div>
                    <div th:if="${param.logout}">
                        <div class="alert alert-success col-xs-offset-1 col-xs-10">
                            You have been logged out.
                        </div>
                    </div>

                    <div class="form-outline mb-4">
                        <label class="form-label" for="email">Email address</label>
                        <input type="email" id="email" name ="username" class="form-control form-control-lg" placeholder="Enter a valid email address" />
                    </div>

                    <div class="form-outline mb-3">
                        <label class="form-label" for="password">Password</label>
                        <input type="password" id="password" name="password" class="form-control form-control-lg" placeholder="Enter password" />
                    </div>

                    <div class="text-center text-lg-start mt-4 pt-2">
                        <button type="submit" class="btn btn-primary btn-lg"
                                style="padding-left: 2.5rem; padding-right: 2.5rem;">Login</button>
                    </div>
                </form>

                <span class="small fw-bold mt-2 pt-1 mb-0" style="display: inline-block; margin-left: 10px;">Don't have an account?</span>
                <form  th:action = "@{/register}"  method="GET" style="display: inline;">
                    <button type="submit" class="link-danger btn btn-link">Register</button>
                </form>

            </div>
        </div>
    </div>
</section>

<script>
    function validateForm() {
        var password = document.getElementById("password").value.trim();
        if (password === "") {
            alert("Password cannot be empty.");
            return false;
        }
        return true;
    }
</script>

<script th:inline="javascript">
    document.getElementById("loginForm").addEventListener("submit", function(event) {
        event.preventDefault();

        var formData = {
            email: document.getElementById("email").value,
            password: document.getElementById("password").value
        };

        fetch('/api/v1/auth/authenticate', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
        })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error('Error:', error);
            });
    });
</script>

</body>
</html>